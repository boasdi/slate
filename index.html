<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>thethings.iO API -  App Development Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #151515;
  background-color: #ac4142;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #505050;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #d0d0d0;
}
.highlight .p, .highlight .pi {
  color: #d0d0d0;
}
.highlight .gi {
  color: #90a959;
}
.highlight .gd {
  color: #ac4142;
}
.highlight .gh {
  color: #6a9fb5;
  background-color: #151515;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #aa759f;
}
.highlight .kc {
  color: #d28445;
}
.highlight .kt {
  color: #d28445;
}
.highlight .kd {
  color: #d28445;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #90a959;
}
.highlight .sr {
  color: #75b5aa;
}
.highlight .si {
  color: #8f5536;
}
.highlight .se {
  color: #8f5536;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #6a9fb5;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #90a959;
}
.highlight .ss {
  color: #90a959;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;ruby&quot;,&quot;python&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="shell">cURL</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/theThings/thethings.iO-arduino-library'>Arduino library</a></br></li>
            <li><a href='https://github.com/theThings/thethings.iO-python-library'>Python library</a></br></li>
            <li><a href='https://github.com/theThings/thethings.iO-TexasInstruments-library'>Texas Instruments library</a></br></br> <a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="developing-iot-apps-with-thethings-io">Developing IoT Apps with thethings.iO</h1>

<p>This document is a guide to understand how to create apps on top of Internet of Things using thethings.iO. It&rsquo;s recommendable to read the <a href="https://developers.thethings.io/index.html">Quickstart guide</a> first to, at least, create an account and activate a thing. </p>

<h1 id="getting-started">Getting started</h1>

<p>Apps are intended to use the HTTP API REST to work with thethings.iO Platform.</p>

<h2 id="postman-collection">Postman Collection</h2>

<p>You can test the following examples importing this postman collection: <a href="https://www.getpostman.com/collections/56301cc95ee8e643f9e5">thethings.iO APP Dev Postman Collection</a></p>

<p>Get Postman: <a href="http://www.getpostman.com/">Postman REST Client</a>.</p>

<h2 id="things-and-resources">Things and Resources</h2>

<p>The <strong>Things</strong> are the virtual representations of your Internet-connected devices.</p>

<p>We can see a <strong>Thing</strong> connected to the Internet as a <strong>collection</strong> of Resources. And each <strong>Resource</strong> can be seen as a <strong>timeline</strong>.</p>

<p>The thing is going to publish or consume this resources. For example, a thing with a temperature sensor is going to publish temperature and a thing that is an on-off switch is going to consume a resource called turn which can take values on or off.</p>

<p><strong>Everything can be a resource</strong>
The value of a resource has not only to be a string or a number it can be an array, a json object or even a binary.</p>

<h1 id="making-an-iot-app">Making an IoT App</h1>

<p>Once you understand the concepts of Thing and Resource, you can start to analyze the requirements of your application.</p>

<p>You must choose a set of resources (it is possible to edit them later) that your app will be using. The possibilities are limitless. For example, you can choose temperature and humidity. Another option would be to choose steps and calories, so the application will be compatible with all the things publishing steps and/or calories (Fitbit, nikeplus,&hellip;) connected to the platform. Or maybe an application to control the energy consumption of a home using the resource power-consumption.</p>

<p>You can register an app from the <a href="https://panel.thethings.io/">Panel</a>. Once registered you will <strong>get an appID to identify your app.</strong></p>

<p>At the same Panel you have to configure which resources will ask your APP for. <strong>This resources must match with the public resources defined on your product.</strong> Product resources remain private and unnaccesible by the APPs until you explicitly define them as public. You can follow the instructions at this page (Create a new IoT Product and Create a new IoT App sections): <a href="https://developers.thethings.io/iot-panel.html">Premium Panel</a>.</p>

<h2 id="setup">Setup</h2>

<p>The first thing you need to do is to send the username, password and appID to register the user, then log the user in so you can get a <strong>session token.</strong></p>

<p>This <strong>session token</strong> is necessary to be sent in the header Authorization in every call to the platform from now on. And will let thethings.iO to identify the user and the application. This session token also contains the list of things and resources the user has authorized the app to access.</p>

<h1 id="register">Register</h1>
<pre class="highlight shell"><code>
<span class="c"># Curl</span>
curl -i -H <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{"email": "YOUR EMAIL HERE", "password": "a hard to guess password", "app": "The appID given in the panel"}'</span> <span class="se">\</span>
  -X POST <span class="s2">"https://api.thethings.io/v2/register"</span> -k

</code></pre>

<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"token"</span>: <span class="s2">"5w3iea4uCCNPkLNkm6R6OpyOPXo"</span>,
  <span class="s2">"expirationDate"</span>: 31536000, //seconds till token expiration
  <span class="s2">"roles"</span>: <span class="o">{</span>
    <span class="s2">"RSRC_description"</span>: <span class="o">{</span>
      <span class="s2">"OTLoG_xxxxxxxx"</span>: <span class="o">{</span>
        <span class="s2">"get"</span>: <span class="nb">true</span>,
        <span class="s2">"post"</span>: <span class="nb">true</span>,
        <span class="s2">"grant"</span>: <span class="nb">true</span>,
        <span class="s2">"put"</span>: <span class="nb">true</span>,
        <span class="s2">"delete"</span>: <span class="nb">true</span>
      <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"RSRC_temperature"</span>: <span class="o">{</span>
      <span class="s2">"OTLoG_xxxxxxxx"</span>: <span class="o">{</span>
        <span class="s2">"get"</span>: <span class="nb">true</span>,
        <span class="s2">"post"</span>: <span class="nb">true</span>,
        <span class="s2">"grant"</span>: <span class="nb">true</span>,
        <span class="s2">"put"</span>: <span class="nb">true</span>,
        <span class="s2">"delete"</span>: <span class="nb">true</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>,
  <span class="s2">"status"</span>: <span class="s2">"success"</span>,
  <span class="s2">"message"</span>: <span class="s2">"user created"</span>
<span class="o">}</span>

</code></pre>

<p>Register an App user at thethings.iO Platform. This endpoint also login the user (returns the session token and roles), so you don&rsquo;t have to do another api call to login him.</p>

<h2 id="http-request">HTTP Request</h2>

<p><code class="prettyprint">POST   https://api.thethings.io/v2/register</code></p>

<h1 id="login">Login</h1>
<pre class="highlight shell"><code>url -i -H <span class="s2">"Accept: application/json"</span> <span class="se">\</span>
  -H <span class="s2">"Content-Type: application/json"</span> <span class="se">\</span>
  -d <span class="s1">'{"email": "YOUR EMAIL HERE", "password": "a hard to guess password", "app": "The appID given in the panel"}'</span> <span class="se">\</span>
  -X POST <span class="s2">"https://api.thethings.io/v2/login"</span> -k
</code></pre>

<blockquote>
<p>Sample Response</p>
</blockquote>
<pre class="highlight shell"><code><span class="o">{</span>
  <span class="s2">"token"</span>: <span class="s2">"5w3iea4uCCNPkLNkm6R6OpyOPXo"</span>,
  <span class="s2">"expirationDate"</span>: 31536000, //seconds till token expiration
  <span class="s2">"roles"</span>: <span class="o">{</span>
    <span class="s2">"RSRC_description"</span>: <span class="o">{</span>
      <span class="s2">"OTLoG_xxxxxxxx"</span>: <span class="o">{</span>
        <span class="s2">"get"</span>: <span class="nb">true</span>,
        <span class="s2">"post"</span>: <span class="nb">true</span>,
        <span class="s2">"grant"</span>: <span class="nb">true</span>,
        <span class="s2">"put"</span>: <span class="nb">true</span>,
        <span class="s2">"delete"</span>: <span class="nb">true</span>
      <span class="o">}</span>
    <span class="o">}</span>,
    <span class="s2">"RSRC_temperature"</span>: <span class="o">{</span>
      <span class="s2">"OTLoG_xxxxxxxx"</span>: <span class="o">{</span>
        <span class="s2">"get"</span>: <span class="nb">true</span>,
        <span class="s2">"post"</span>: <span class="nb">true</span>,
        <span class="s2">"grant"</span>: <span class="nb">true</span>,
        <span class="s2">"put"</span>: <span class="nb">true</span>,
        <span class="s2">"delete"</span>: <span class="nb">true</span>
      <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</code></pre>

<p>Login an App user at thethings.iO Platform. Returns the session token and roles. Roles identifies the resources and things that the user has authorized the App to access.</p>

<h2 id="http-request">HTTP Request</h2>

<p><code class="prettyprint">POST   https://api.thethings.io/v2/login</code></p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">cURL</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
